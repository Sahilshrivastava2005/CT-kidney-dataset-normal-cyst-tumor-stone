[2026-02-22 18:04:42,390] INFO - ========== APPLICATION STARTED ==========
[2026-02-22 18:04:42,390] INFO - Processed dataset already exists. Skipping preprocessing.
[2026-02-22 18:04:42,390] INFO - Loading existing base model...
[2026-02-22 18:04:43,396] INFO - Starting training pipeline...
[2026-02-22 18:04:43,396] INFO - ===== TRAINING STARTED =====
[2026-02-22 18:04:43,502] INFO - Datasets ready
[2026-02-22 18:04:43,528] INFO - Class weights: {0: np.float64(0.8388945062352544), 1: np.float64(0.6129032258064516), 2: np.float64(2.2586206896551726), 3: np.float64(1.3630887185104053)}
[2026-02-22 18:04:43,528] INFO - Loading existing base model...
[2026-02-22 18:04:44,149] INFO - Model ready
[2026-02-22 18:04:44,155] INFO - Model: "sequential"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ efficientnetb0 (Functional)          │ (None, 7, 7, 1280)          │       4,049,571 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ global_average_pooling2d             │ (None, 1280)                │               0 │
│ (GlobalAveragePooling2D)             │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense (Dense)                        │ (None, 128)                 │         163,968 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout (Dropout)                    │ (None, 128)                 │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_1 (Dense)                      │ (None, 4)                   │             516 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 4,214,055 (16.08 MB)
 Trainable params: 164,484 (642.52 KB)
 Non-trainable params: 4,049,571 (15.45 MB)

[2026-02-22 18:04:44,155] INFO - Phase 1: Training with frozen base...
[2026-02-22 18:04:44,155] ERROR - Error during training
Traceback (most recent call last):
  File "/Users/sahilshrivastava/Documents/Potato Disease Classification/my_dl_project/src/train.py", line 107, in train
    history = model.fit(
              ^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/utils/traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/trainers/trainer.py", line 1058, in _assert_compile_called
    raise ValueError(msg)
ValueError: You must call `compile()` before using the model.
[2026-02-22 18:04:44,157] ERROR - Application crashed
Traceback (most recent call last):
  File "/Users/sahilshrivastava/Documents/Potato Disease Classification/my_dl_project/main.py", line 36, in main
    train()
  File "/Users/sahilshrivastava/Documents/Potato Disease Classification/my_dl_project/src/train.py", line 148, in train
    raise e
  File "/Users/sahilshrivastava/Documents/Potato Disease Classification/my_dl_project/src/train.py", line 107, in train
    history = model.fit(
              ^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/utils/traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/keras/src/trainers/trainer.py", line 1058, in _assert_compile_called
    raise ValueError(msg)
ValueError: You must call `compile()` before using the model.
